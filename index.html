<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Repartidor | SAL DEL SERI</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
* {
  box-sizing: border-box;
}

body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: #f4f4f4;
}

header {
  background: #e46b0a;
  padding: 15px;
  text-align: center;
}

header img {
  max-width: 180px;
}

.contenedor {
  max-width: 900px;
  margin: auto;
  padding: 15px;
}

h2 {
  margin-top: 10px;
  text-align: center;
}

.pedido {
  background: #fff;
  border-radius: 8px;
  padding: 15px;
  margin-bottom: 15px;
  box-shadow: 0 2px 5px rgba(0,0,0,0.1);
}

.pedido.entregado {
  color: #1fa84f;
  font-weight: bold;
}

.pedido small {
  display: block;
  margin-top: 3px;
}

.botones {
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  margin-top: 10px;
}

.botones button {
  flex: 1;
  padding: 10px;
  border: none;
  border-radius: 5px;
  cursor: pointer;
  font-size: 14px;
}

.maps {
  background: #34a853;
  color: white;
}

.waze {
  background: #1da1f2;
  color: white;
}

.entregar {
  background: #1fa84f;
  color: white;
}

@media (max-width: 600px) {
  .botones {
    flex-direction: column;
  }
}
</style>
</head>

<body>

<header>
  <!-- üî• LOGO SAL DEL SERI -->
  <img src="yiyi.png" alt="SAL DEL SERI">
</header>

<div class="contenedor">
  <h2>Pedidos pendientes</h2>
  <div id="listaPedidos"></div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getFirestore, collection, onSnapshot, updateDoc, doc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

/* üî• FIREBASE CONFIG */
const firebaseConfig = {
  apiKey: "AIzaSyDMBBaEgAk1EuRj7QSMqVsxnlC7aUvMz5w",
  authDomain: "sal-del-seri.firebaseapp.com",
  projectId: "sal-del-seri",
  storageBucket: "sal-del-seri.firebasestorage.app",
  messagingSenderId: "465867166498",
  appId: "1:465867166498:web:683a92396f3e369df4cb7b"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const listaPedidos = document.getElementById("listaPedidos");

/* üîÑ PEDIDOS EN TIEMPO REAL */
onSnapshot(collection(db, "pedidos"), snapshot => {
  listaPedidos.innerHTML = "";

  if (snapshot.empty) {
    listaPedidos.innerHTML = "<p>No hay pedidos.</p>";
    return;
  }

  snapshot.forEach(docSnap => {
    const pedido = docSnap.data();
    const id = docSnap.id;

    const div = document.createElement("div");
    div.classList.add("pedido");

    if (pedido.estado === "entregado") {
      div.classList.add("entregado");
    }

    const direccionURL = encodeURIComponent(pedido.direccion);

    div.innerHTML = `
      <strong>${pedido.negocio}</strong>
      <small>Responsable: ${pedido.responsable}</small>
      <small>Tel√©fono: ${pedido.telefono}</small>
      <small>Direcci√≥n: ${pedido.direccion}</small>
      <small>Sacos: ${pedido.sacos}</small>
      <small>Total: $${pedido.total} MXN</small>

      <div class="botones">
        <button class="maps"
          onclick="window.open('https://www.google.com/maps/search/?api=1&query=${direccionURL}', '_blank')">
          Google Maps
        </button>

        <button class="waze"
          onclick="window.open('https://waze.com/ul?q=${direccionURL}', '_blank')">
          Waze
        </button>

        ${pedido.estado !== "entregado" ? `
        <button class="entregar" onclick="entregarPedido('${id}')">
          Marcar entregado
        </button>` : ``}
      </div>
    `;

    listaPedidos.appendChild(div);
  });
});

/* ‚úÖ MARCAR COMO ENTREGADO */
window.entregarPedido = async (id) => {
  await updateDoc(doc(db, "pedidos", id), {
    estado: "entregado"
  });
};
</script>

</body>
</html>













